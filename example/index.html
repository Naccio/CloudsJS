<!DOCTYPE html>
<html>

<head>
  <meta charset="utf-8">
  <title>Clouds.js</title>
  <link href="style.css" rel="stylesheet" />
</head>

<body>

  <canvas id="canvas"></canvas>
  <canvas id="bg-canvas"></canvas>
  <canvas id="static-bg-canvas"></canvas>
  <div id="content">
    <h1>
      CLOUDS.JS
      <small>A JavaScript module for creating and animating clouds</small>
    </h1>
    <div id="controls">
      <button id="play-pause" role="button">Pause</button>
      <label for="wind">Wind direction</label>
      <input id="wind" type="range" min="0" max="360" list="markers" value="0" />
      <span id="wind-display">0°</span>

      <datalist id="markers">
        <option value="0" label="0°"></option>
        <option value="90" label="90°"></option>
        <option value="180" label="180°"></option>
        <option value="270" label="270°"></option>
        <option value="360" label="360°"></option>
      </datalist>

      <a href="https://github.com/Naccio/CloudsJS" target="_blank" title="Repository">&lt;/&gt;</a>
    </div>
  </div>

</body>

<script src="./clouds.min.js" type="module"></script>
<script type="module">
  import { default as Clouds, createCloud, drawCloud } from "./clouds.min.js";

  const w = window.innerWidth;
  const h = window.innerHeight;

  // Static usage
  const staticBgCanvas = document.getElementById('static-bg-canvas');
  const staticBgContext = staticBgCanvas.getContext('2d');

  staticBgCanvas.width = w;
  staticBgCanvas.height = h;

  const cloud = createCloud(w / 2, h / 2, w, h, 60, { r: 150, g: 150, b: 150, a: 0.4 }, 4);

  staticBgContext.fillStyle = 'skyblue';
  staticBgContext.fillRect(0, 0, w, h);
  drawCloud(cloud, staticBgContext);

  // Animated usage
  const canvas = document.getElementById('canvas');
  const bgCanvas = document.getElementById('bg-canvas');

  canvas.width = w;
  canvas.height = h;
  bgCanvas.width = w;
  bgCanvas.height = h;

  const clouds = new Clouds(canvas);
  const bgClouds = new Clouds(bgCanvas);
  const bigW = w * 3 / 4;
  const smallW = w * 1 / 2;
  const bigH = h * 3 / 4;
  const smallH = h * 1 / 2;

  bgClouds.add(w / 4, h / 4, bigW, bigH, 20, { r: 120, g: 120, b: 120, a: 0.4 }, 16);
  bgClouds.add(w / 3, h / 3, bigW, bigH, 30, { r: 170, g: 170, b: 170, a: 0.4 }, 8);
  bgClouds.add(w * 3 / 4, h * 3 / 4, bigW, bigH, 30, { r: 180, g: 180, b: 180, a: 0.4 }, 24);

  clouds.add(w * 3 / 4, h / 4, bigW, bigH, 45, { r: 200, g: 200, b: 200, a: 0.2 }, 50);
  clouds.add(-w * 3 / 4, h * 3 / 4, bigW, bigH, 30, { r: 230, g: 230, b: 230, a: 0.2 }, 110);
  clouds.add(-w / 2, h / 2, smallW, smallH, 40, { r: 245, g: 245, b: 245, a: 0.2 }, 80);
  clouds.add(-w * 3 / 4, h / 4, smallW, smallH, 40, { r: 215, g: 215, b: 215, a: 0.2 }, 140);

  // Controls
  const playPause = document.getElementById('play-pause'),
    windInput = document.getElementById('wind'),
    windDisplay = document.getElementById('wind-display');

  let running;

  playPause.addEventListener('click', () => {
    if (running) {
      pause();
    } else {
      play();
    }
  });

  windInput.addEventListener('input', () => {
    const wind = windInput.value * (Math.PI / 180);
    clouds.setWindDirection(wind);
    bgClouds.setWindDirection(wind);
    windDisplay.innerText = windInput.value + '°';
  });

  function play() {
    bgClouds.run();
    clouds.run();
    running = true;
    playPause.innerText = 'Pause';
  }

  function pause() {
    bgClouds.pause();
    clouds.pause();
    running = false;
    playPause.innerText = 'Play';
  }

  play();
</script>

</html>